## 1- 简介

### 1.1 - semver 简介

semver 是 [语义化版本（Semantic Versioning）规范](http://semver.org/lang/zh-CN/) 的一个实现，目前是由 npm 的团队维护，实现了版本和版本范围的解析、计算、比较。

### 1.2 - semver 的两个概念

<span style="color: #ab04d9">**固定目前可用的官方模版版本**</span> 

指表示包的特定版本的字符串,例如 0.4.1、 1.2.7、 1.2.4-0

<span style="color: #ab04d9">**范围版本**</span> 

指对满足特定规则的版本的一种表示，例如 1.2.3-2.3.4、1.x 、^0.2 、>1.4

### 1.3 - 定义依赖版本号

在 [npm](https://npmjs.com/) 的依赖的规则中，还有 `~`、`>`、`<`、`=`、`>=`、`<=`、`-`、`||`、`x`、`X`、`*` 等符号；当使用 `npm install XX` 时，被安装的依赖的版本号前会默认加上 `^` 符号。

- `^` ：表示同一主版本号中，不小于指定版本号的版本号

    ```go
     `^2.2.1` 对应主版本号为 2，不小于 `2.2.1` 的版本号，比如 `2.2.1`、`2.2.2`、`2.3.0` ,主版本号固定
    // 当该依赖有最新版本时(eg:2.3.3)，npm install 会安装最新的依赖
    ```

- 

    ```sh
     `^2.2.1` 对应主版本号为 2，不小于 `2.2.1` 的版本号，比如 `2.2.1`、`2.2.2`、`2.3.0` ,主版本号固定
    // 当该依赖有最新版本时(eg:2.3.3)，npm install 会安装最新的依赖
    ```

- `~` ：表示同一主版本号和次版本号中，不小于指定版本号的版本号

    ```go
    `~2.2.1` 对应主版本号为 2，次版本号为 2，不小于 `2.2.1` 的版本号，比如 `2.2.1、2.2.2`，主版本号和次版本号固定
    ```

- `>`、`<`、`=`、`>=`、`<=`、`-`：用来指定一个版本号范围

    ```go
     `>2.1`
     `1.0.0 - 1.2.0`
    //注意使用 `-` 的时候，必须两边都有空格。
    ```

- `||`：表示或

    ```go
     `^2 <2.2 || > 2.3`
    ```

- `x`、`X`、`*`：表示通配符

    ```go
     `*` 对应所有版本号
     `3.x` 对应所有主版本号为 3 的版本号
    ```

### 1.3 - 版本号格式

版本格式：主版本号.次版本号.修订号，版本号递增规则如下：

- 主版本号(major)：当你做了不兼容的 API 修改， <span style="color: #e3371e">大版本</span> 
- 次版本号(minor)：当你做了向下兼容的功能性新增， <span style="color: #0099dd">功能版本</span> 

- 修订号(patch)：当你做了向下兼容的问题修正。 <span style="color: #49bf51">Bug修复版本</span> 

先行版本号及版本编译信息可以加到“主版本号.次版本号.修订号”的后面，作为延伸

> 当主版本号升级后，次版本号和修订号需要重置为 0 ；
>
> 次版本号升级后，修订版本号需要重置为 0 。

### 1.4 - 先行版本号（Pre-release Version）

先行版本号可以作为发布正式版之前的版本

格式：

- 在修订版本号后面加上一个连接号（-），再加上一连串以点（.）分割的标识符
- 标识符可以由英文、数字和连接号（[0-9A-Za-z-]）组成

```sh
1.0.0-alpha
1.0.0-alpha.1
1.0.0-0.3.7
1.0.0-x.7.z.92
```

## 2 - 语义化版本控制规范（SemVer）

以下关键词 MUST、MUST NOT、REQUIRED、SHALL、SHALL NOT、SHOULD、SHOULD NOT、 RECOMMENDED、MAY、OPTIONAL 依照 <span style="color: #e3371e">RFC 2119</span> 的叙述解读

- 使用语义化版本控制的软件必须（MUST）定义公共 API。
    - 该 API 可以在代码中被定义或出现于严谨的文件内。无论何种形式都应该力求精确且完整。

- 标准的版本号必须（MUST）采用 X.Y.Z 的格式
    - 其中 X、Y 和 Z 为非负的整数，且禁止（MUST NOT）在数字前方补零。
        - X 是主版本号
        - Y 是次版本号
        - Z 为修订号。
        - 每个元素必须（MUST）以数值来递增。例如：1.9.1 -> 1.10.0 -> 1.11.0

- 标记版本号的软件发行后，禁止（MUST NOT）改变该版本软件的内容。任何修改都必须（MUST）以新版本发行。

- 主版本号为零（0.y.z）的软件处于开发初始阶段，一切都可能随时被改变。这样的公共 API 不应该被视为稳定版。

- 1.0.0 的版本号用于界定公共 API 的形成。这一版本之后所有的版本号更新都基于公共 API 及其修改内容。

- 修订号 Z（x.y.Z `|` x > 0）必须（MUST）在只做了向下兼容的修正时才递增。
    - 这里的修正指的是针对不正确结果而进行的内部修改。

- 次版本号 Y（x.Y.z `|` x > 0）必须（MUST）在有向下兼容的新功能出现时递增。
    - 在任何公共 API 的功能被标记为弃用时也必须（MUST）递增。也可以（MAY）在内部程序有大量新功能或改进被加入时递增，其中可以（MAY）包括修订级别的改变。每当次版本号递增时，修订号必须（MUST）归零。

- 主版本号 X（X.y.z `|` X > 0）必须（MUST）在有任何不兼容的修改被加入公共 API 时递增。
    - 其中可以（MAY）包括次版本号及修订级别的改变。每当主版本号递增时，次版本号和修订号必须（MUST）归零。

- 先行版本号可以（MAY）被标注在修订版之后，先加上一个连接号再加上一连串以句点分隔的标识符来修饰。标识符必须（MUST）由 ASCII 字母数字和连接号 [0-9A-Za-z-] 组成，且禁止（MUST NOT）留白。数字型的标识符禁止（MUST NOT）在前方补零。先行版的优先级低于相关联的标准版本。被标上先行版本号则表示这个版本并非稳定而且可能无法满足预期的兼容性需求。范例：1.0.0-alpha、1.0.0-alpha.1、1.0.0-0.3.7、1.0.0-x.7.z.92。

- 版本编译信息可以（MAY）被标注在修订版或先行版本号之后，先加上一个加号再加上一连串以句点分隔的标识符来修饰。标识符必须（MUST）由 ASCII 字母数字和连接号 [0-9A-Za-z-] 组成，且禁止（MUST NOT）留白。当判断版本的优先层级时，版本编译信息可（SHOULD）被忽略。因此当两个版本只有在版本编译信息有差别时，属于相同的优先层级。范例：1.0.0-alpha+001、1.0.0+20130313144700、1.0.0-beta+exp.sha.5114f85。

- 版本的优先层级指的是不同版本在排序时如何比较。判断优先层级时，必须（MUST）把版本依序拆分为主版本号、次版本号、修订号及先行版本号后进行比较（版本编译信息不在这份比较的列表中）。由左到右依序比较每个标识符，第一个差异值用来决定优先层级：主版本号、次版本号及修订号以数值比较，例如：1.0.0 < 2.0.0 < 2.1.0 < 2.1.1。当主版本号、次版本号及修订号都相同时，改以优先层级比较低的先行版本号决定。例如：1.0.0-alpha < 1.0.0。有相同主版本号、次版本号及修订号的两个先行版本号，其优先层级必须（MUST）透过由左到右的每个被句点分隔的标识符来比较，直到找到一个差异值后决定：只有数字的标识符以数值高低比较，有字母或连接号时则逐字以 ASCII 的排序来比较。数字的标识符比非数字的标识符优先层级低。若开头的标识符都相同时，栏位比较多的先行版本号优先层级比较高。范例：1.0.0-alpha < 1.0.0-alpha.1 < 1.0.0-alpha.beta < 1.0.0-beta < 1.0.0-beta.2 < 1.0.0-beta.11 < 1.0.0-rc.1 < 1.0.0。

